<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartPiXL &mdash; Atlas</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <!-- Mermaid.js -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.min.js"></script>

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>

    <style>
        /* ================================================================
           DESIGN SYSTEM
           ================================================================ */
        :root {
            --bg-base: #060a13;
            --bg-surface: #0c1221;
            --bg-card: #111a2e;
            --bg-card-hover: #162040;
            --bg-elevated: #1a2540;
            --bg-panel: #0a1020;
            --bg-reading: #0d1525;

            --text-primary: #edf2f7;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --text-dim: #475569;

            --accent-blue: #3b82f6;
            --accent-blue-light: #60a5fa;
            --accent-purple: #8b5cf6;
            --accent-green: #10b981;
            --accent-amber: #f59e0b;
            --accent-red: #ef4444;
            --accent-cyan: #06b6d4;

            --gradient-brand: linear-gradient(135deg, #3b82f6, #8b5cf6);
            --gradient-text: linear-gradient(135deg, #60a5fa, #a78bfa);
            --gradient-green: linear-gradient(135deg, #10b981, #06b6d4);
            --gradient-amber: linear-gradient(135deg, #f59e0b, #ef4444);

            --border: rgba(255,255,255,0.06);
            --border-light: rgba(255,255,255,0.1);
            --border-active: rgba(59,130,246,0.4);

            --status-live: #10b981;
            --status-complete: #3b82f6;
            --status-inprogress: #f59e0b;
            --status-planned: #64748b;

            --radius: 16px;
            --radius-sm: 10px;
            --radius-xs: 6px;
            --ease: cubic-bezier(0.4, 0, 0.2, 1);
            --spring: cubic-bezier(0.34, 1.56, 0.64, 1);
            --font-body: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            --font-mono: 'JetBrains Mono', 'Fira Code', monospace;

            /* Category accent colors */
            --cat-architecture: #8b5cf6;
            --cat-subsystems: #3b82f6;
            --cat-database: #10b981;
            --cat-operations: #f59e0b;
        }

        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }

        body {
            font-family: var(--font-body);
            background: var(--bg-base);
            color: var(--text-primary);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow-x: hidden;
        }

        /* ================================================================
           TYPOGRAPHY
           ================================================================ */
        h1 { font-size: clamp(2.5rem, 5vw, 4rem); font-weight: 900; letter-spacing: -0.04em; line-height: 1.05; }
        h2 { font-size: clamp(1.5rem, 3vw, 2.25rem); font-weight: 800; letter-spacing: -0.03em; line-height: 1.15; }
        h3 { font-size: 1.15rem; font-weight: 700; letter-spacing: -0.02em; }
        p  { color: var(--text-secondary); }

        a { color: var(--accent-blue-light); text-decoration: none; }
        a:hover { text-decoration: underline; }

        code, pre { font-family: var(--font-mono); font-size: 0.85rem; }
        code {
            background: rgba(59,130,246,0.1);
            color: #93c5fd;
            padding: 0.15em 0.4em;
            border-radius: 4px;
        }
        pre {
            background: #080d18;
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            padding: 1rem 1.25rem;
            overflow-x: auto;
            line-height: 1.6;
        }
        pre code { background: none; padding: 0; color: var(--text-primary); }

        /* ================================================================
           LAYOUT
           ================================================================ */
        .container    { max-width: 1200px; margin: 0 auto; padding: 0 2rem; }
        .container-xl { max-width: 1440px; margin: 0 auto; padding: 0 2rem; }

        /* ================================================================
           STICKY NAV
           ================================================================ */
        .nav {
            position: fixed;
            top: 0; left: 0; right: 0;
            z-index: 1000;
            padding: 0 2rem;
            height: 56px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: rgba(6,10,19,0.92);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border);
            transform: translateY(-100%);
            pointer-events: none;
            transition: transform 0.35s var(--ease);
        }
        .nav.visible { transform: translateY(0); pointer-events: auto; }

        .nav-brand {
            font-weight: 800;
            font-size: 1rem;
            letter-spacing: -0.02em;
            background: var(--gradient-text);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .nav-right { display: flex; align-items: center; gap: 1.5rem; }
        .nav-links { display: flex; gap: 1.5rem; }
        .nav-links a {
            color: var(--text-muted);
            font-size: 0.85rem;
            font-weight: 500;
            transition: color 0.3s var(--ease);
        }
        .nav-links a:hover { color: var(--text-primary); text-decoration: none; }

        /* ================================================================
           BIONIC READING TOGGLE
           ================================================================ */
        .bionic-toggle {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.35rem 0.85rem;
            background: rgba(255,255,255,0.04);
            border: 1px solid var(--border);
            border-radius: 9999px;
            color: var(--text-muted);
            font-size: 0.75rem;
            font-weight: 600;
            font-family: var(--font-body);
            cursor: pointer;
            transition: all 0.3s var(--ease);
            user-select: none;
        }
        .bionic-toggle:hover { border-color: var(--border-light); color: var(--text-secondary); background: rgba(255,255,255,0.06); }
        .bionic-toggle.active { border-color: var(--accent-cyan); color: var(--accent-cyan); background: rgba(6,182,212,0.08); }
        .bionic-toggle svg { width: 14px; height: 14px; }

        .bionic-switch {
            width: 32px; height: 18px;
            border-radius: 9999px;
            background: var(--bg-elevated);
            border: 1px solid var(--border-light);
            position: relative;
            transition: all 0.3s var(--ease);
        }
        .bionic-switch::after {
            content: '';
            position: absolute;
            width: 12px; height: 12px;
            border-radius: 50%;
            background: var(--text-muted);
            top: 2px; left: 2px;
            transition: all 0.3s var(--ease);
        }
        .bionic-toggle.active .bionic-switch {
            background: rgba(6,182,212,0.2);
            border-color: var(--accent-cyan);
        }
        .bionic-toggle.active .bionic-switch::after {
            transform: translateX(14px);
            background: var(--accent-cyan);
        }

        /* Bionic reading effect */
        body.bionic-reading .tier-html p,
        body.bionic-reading .tier-html li,
        body.bionic-reading .tier-html td,
        body.bionic-reading .card-pitch p,
        body.bionic-reading .hero-subtitle {
            /* Applied via JS to individual text nodes */
        }

        .bionic-bold {
            font-weight: 700 !important;
            color: var(--text-primary) !important;
        }

        /* ================================================================
           HERO
           ================================================================ */
        .hero {
            position: relative;
            min-height: 480px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 5rem 2rem 3rem;
            overflow: hidden;
        }

        .hero-glow-1, .hero-glow-2, .hero-glow-3 {
            position: absolute;
            border-radius: 50%;
            filter: blur(100px);
            pointer-events: none;
        }
        .hero-glow-1 {
            width: 700px; height: 700px;
            background: radial-gradient(circle, rgba(59,130,246,0.12), transparent 70%);
            top: -30%; left: -15%;
            animation: glow1 18s ease-in-out infinite alternate;
        }
        .hero-glow-2 {
            width: 500px; height: 500px;
            background: radial-gradient(circle, rgba(139,92,246,0.10), transparent 70%);
            bottom: -25%; right: -10%;
            animation: glow2 22s ease-in-out infinite alternate;
        }
        .hero-glow-3 {
            width: 400px; height: 400px;
            background: radial-gradient(circle, rgba(16,185,129,0.06), transparent 70%);
            top: 20%; left: 55%;
            animation: glow3 20s ease-in-out infinite alternate;
        }
        @keyframes glow1 { 0% { transform: translate(0,0); } 100% { transform: translate(60px,40px); } }
        @keyframes glow2 { 0% { transform: translate(0,0); } 100% { transform: translate(-50px,-30px); } }
        @keyframes glow3 { 0% { transform: translate(0,0); } 100% { transform: translate(40px,-50px); } }

        .hero-grid {
            position: absolute; inset: 0;
            background-image: radial-gradient(rgba(255,255,255,0.03) 1px, transparent 1px);
            background-size: 32px 32px;
            pointer-events: none;
        }

        .hero-content {
            position: relative; z-index: 1;
            text-align: center;
            max-width: 800px;
        }
        .hero h1 {
            margin-bottom: 0.75rem;
            background: var(--gradient-text);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .hero-subtitle {
            font-size: clamp(1rem, 1.5vw, 1.15rem);
            color: var(--text-secondary);
            max-width: 560px;
            margin: 0 auto 2.5rem;
            line-height: 1.75;
        }

        /* Hero Metrics */
        .hero-metrics {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
        }
        .hero-metric-card {
            background: rgba(255,255,255,0.03);
            backdrop-filter: blur(12px);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 1rem 1.75rem;
            min-width: 140px;
            text-align: center;
            transition: all 0.3s var(--ease);
        }
        .hero-metric-card:hover {
            border-color: var(--border-light);
            background: rgba(255,255,255,0.05);
            transform: translateY(-2px);
        }
        .hero-metric-value {
            font-size: 1.75rem;
            font-weight: 800;
            letter-spacing: -0.03em;
            background: var(--gradient-text);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .hero-metric-label {
            font-size: 0.65rem;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.08em;
            margin-top: 0.3rem;
        }

        /* ================================================================
           SEARCH
           ================================================================ */
        .search-container {
            max-width: 480px;
            margin: 0 auto 1rem;
            position: relative;
        }
        .search-input {
            width: 100%;
            padding: 0.7rem 1.25rem 0.7rem 2.75rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 9999px;
            color: var(--text-primary);
            font-family: var(--font-body);
            font-size: 0.9rem;
            outline: none;
            transition: all 0.3s var(--ease);
        }
        .search-input::placeholder { color: var(--text-dim); }
        .search-input:focus { border-color: var(--accent-blue); background: var(--bg-elevated); box-shadow: 0 0 0 3px rgba(59,130,246,0.1); }
        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-dim);
            width: 18px; height: 18px;
            pointer-events: none;
        }

        /* ================================================================
           CATEGORY TABS
           ================================================================ */
        .category-tabs {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.5rem 0 2rem;
            flex-wrap: wrap;
        }
        .category-tab {
            padding: 0.55rem 1.25rem;
            background: rgba(255,255,255,0.03);
            border: 1px solid var(--border);
            border-radius: 9999px;
            color: var(--text-muted);
            font-size: 0.8rem;
            font-weight: 600;
            font-family: var(--font-body);
            cursor: pointer;
            transition: all 0.3s var(--ease);
            user-select: none;
        }
        .category-tab:hover {
            color: var(--text-secondary);
            border-color: var(--border-light);
            background: rgba(255,255,255,0.05);
        }
        .category-tab.active {
            color: var(--text-primary);
            background: rgba(59,130,246,0.1);
            border-color: var(--accent-blue);
        }
        .category-tab .tab-count {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: 20px;
            height: 20px;
            padding: 0 6px;
            background: rgba(255,255,255,0.06);
            border-radius: 9999px;
            font-size: 0.7rem;
            margin-left: 0.4rem;
        }
        .category-tab.active .tab-count {
            background: rgba(59,130,246,0.2);
            color: var(--accent-blue-light);
        }

        /* ================================================================
           FEATURE GRID
           ================================================================ */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.25rem;
            padding-bottom: 2rem;
        }

        .feature-card {
            position: relative;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.35s var(--ease);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .feature-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 3px;
            border-radius: var(--radius) var(--radius) 0 0;
            background: var(--gradient-brand);
            opacity: 0;
            transition: opacity 0.3s var(--ease);
        }
        .feature-card:hover {
            border-color: var(--border-light);
            background: var(--bg-card-hover);
            transform: translateY(-3px);
            box-shadow: 0 12px 40px rgba(0,0,0,0.3);
        }
        .feature-card:hover::before { opacity: 1; }
        .feature-card.active { border-color: var(--border-active); background: var(--bg-card-hover); }
        .feature-card.active::before { opacity: 1; }

        /* Category-colored top bar */
        .feature-card[data-category="Architecture"]::before { background: var(--cat-architecture); }
        .feature-card[data-category="Subsystems"]::before { background: var(--cat-subsystems); }
        .feature-card[data-category="Database"]::before { background: var(--cat-database); }
        .feature-card[data-category="Operations"]::before { background: var(--cat-operations); }

        .card-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.85rem;
        }
        .card-icon {
            width: 38px; height: 38px;
            border-radius: var(--radius-xs);
            background: linear-gradient(135deg, rgba(59,130,246,0.12), rgba(139,92,246,0.12));
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--accent-blue);
            flex-shrink: 0;
        }
        .card-icon svg { width: 18px; height: 18px; }

        .card-title-group { flex: 1; min-width: 0; }
        .card-title {
            font-size: 1rem;
            font-weight: 700;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .card-category {
            font-size: 0.65rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: var(--text-dim);
        }

        .card-pitch {
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 1.65;
            flex: 1;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        .card-pitch p { font-size: inherit; max-width: none; margin: 0; }

        .card-footer {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 1rem;
            padding-top: 0.75rem;
            border-top: 1px solid var(--border);
        }

        .card-tier-dots {
            display: flex;
            gap: 0.35rem;
        }
        .tier-dot {
            width: 7px; height: 7px;
            border-radius: 50%;
            background: var(--text-dim);
            opacity: 0.3;
            transition: all 0.3s var(--ease);
        }
        .tier-dot.filled { opacity: 1; }
        .tier-dot.t1 { background: var(--accent-green); }
        .tier-dot.t2 { background: var(--accent-blue); }
        .tier-dot.t3 { background: var(--accent-purple); }
        .tier-dot.t4 { background: var(--accent-amber); }

        .card-explore {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            padding: 0;
            background: none;
            border: none;
            color: var(--accent-blue);
            font-size: 0.78rem;
            font-weight: 600;
            font-family: var(--font-body);
            cursor: pointer;
            transition: gap 0.3s var(--ease), color 0.3s var(--ease);
        }
        .card-explore:hover { gap: 0.6rem; color: var(--accent-blue-light); }
        .card-explore svg { width: 14px; height: 14px; }

        /* ================================================================
           READING PANEL (full page overlay)
           ================================================================ */
        .reading-overlay {
            position: fixed;
            inset: 0;
            z-index: 2000;
            display: none;
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(4px);
        }
        .reading-overlay.open { display: flex; }

        .reading-panel {
            position: fixed;
            top: 0; right: 0; bottom: 0;
            width: min(900px, 100vw);
            background: var(--bg-reading);
            border-left: 1px solid var(--border);
            z-index: 2001;
            display: flex;
            flex-direction: column;
            transform: translateX(100%);
            transition: transform 0.4s var(--ease);
            overflow: hidden;
        }
        .reading-panel.open { transform: translateX(0); }

        .reading-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1.25rem 2rem;
            border-bottom: 1px solid var(--border);
            background: rgba(6,10,19,0.5);
            backdrop-filter: blur(10px);
            flex-shrink: 0;
        }
        .reading-title-group {
            display: flex;
            align-items: center;
            gap: 0.85rem;
            min-width: 0;
        }
        .reading-icon {
            width: 40px; height: 40px;
            border-radius: var(--radius-xs);
            background: var(--gradient-brand);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            flex-shrink: 0;
        }
        .reading-icon svg { width: 20px; height: 20px; }
        .reading-title { font-size: 1.25rem; font-weight: 800; letter-spacing: -0.02em; }
        .reading-category {
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: var(--text-dim);
        }

        .reading-close {
            width: 36px; height: 36px;
            border-radius: 50%;
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border);
            color: var(--text-muted);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s var(--ease);
            flex-shrink: 0;
        }
        .reading-close:hover { background: rgba(255,255,255,0.1); color: var(--text-primary); }
        .reading-close svg { width: 18px; height: 18px; }

        /* Tier tab bar */
        .tier-tabs {
            display: flex;
            padding: 0 2rem;
            gap: 0;
            border-bottom: 1px solid var(--border);
            background: var(--bg-surface);
            flex-shrink: 0;
        }
        .tier-tab {
            padding: 0.85rem 1.25rem;
            background: none;
            border: none;
            border-bottom: 2px solid transparent;
            color: var(--text-muted);
            font-size: 0.8rem;
            font-weight: 600;
            font-family: var(--font-body);
            cursor: pointer;
            transition: all 0.3s var(--ease);
            white-space: nowrap;
        }
        .tier-tab:hover { color: var(--text-secondary); }
        .tier-tab.active { color: var(--text-primary); border-bottom-color: var(--accent-blue); }
        .tier-tab.t-public.active { border-bottom-color: var(--accent-green); }
        .tier-tab.t-internal.active { border-bottom-color: var(--accent-blue); }
        .tier-tab.t-technical.active { border-bottom-color: var(--accent-purple); }
        .tier-tab.t-private.active { border-bottom-color: var(--accent-amber); }

        .tier-tab .tier-tab-label {
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
        }
        .tier-tab .tier-indicator {
            width: 6px; height: 6px;
            border-radius: 50%;
            background: currentColor;
            opacity: 0.5;
        }
        .tier-tab.active .tier-indicator { opacity: 1; }

        /* Reading body / scrollable content */
        .reading-body {
            flex: 1;
            overflow-y: auto;
            padding: 2rem;
            scroll-behavior: smooth;
        }
        .reading-body::-webkit-scrollbar { width: 6px; }
        .reading-body::-webkit-scrollbar-track { background: transparent; }
        .reading-body::-webkit-scrollbar-thumb { background: var(--border-light); border-radius: 3px; }
        .reading-body::-webkit-scrollbar-thumb:hover { background: var(--text-dim); }

        /* Mermaid diagram in reading panel */
        .reading-diagram {
            background: #080d18;
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            padding: 2rem;
            margin-bottom: 2rem;
            text-align: center;
            overflow-x: auto;
        }
        .reading-diagram:empty { display: none; }

        .tier-content { display: none; }
        .tier-content.active { display: block; }

        /* ================================================================
           TIER HTML CONTENT STYLING
           ================================================================ */
        .tier-html {
            color: var(--text-secondary);
            line-height: 1.85;
            font-size: 0.925rem;
            max-width: 720px;
        }
        .tier-html p { margin-bottom: 1.15rem; max-width: none; font-size: inherit; }
        .tier-html ul, .tier-html ol { margin: 0.75rem 0 1.25rem 1.5rem; }
        .tier-html li { margin-bottom: 0.5rem; }
        .tier-html strong { color: var(--text-primary); font-weight: 600; }
        .tier-html h3 { margin: 2rem 0 0.75rem; color: var(--text-primary); font-size: 1.15rem; border-bottom: 1px solid var(--border); padding-bottom: 0.5rem; }
        .tier-html h4 { margin: 1.75rem 0 0.65rem; color: var(--text-primary); font-size: 1.05rem; }
        .tier-html h5 { margin: 1.25rem 0 0.5rem; color: var(--text-primary); font-size: 0.95rem; }

        .tier-html blockquote {
            border-left: 3px solid var(--accent-blue);
            padding: 0.75rem 1rem;
            margin: 1rem 0;
            background: rgba(59,130,246,0.05);
            border-radius: 0 var(--radius-xs) var(--radius-xs) 0;
        }
        .tier-html blockquote p { color: var(--text-secondary); margin-bottom: 0.25rem; }

        .tier-html table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0 1.5rem;
            font-size: 0.85rem;
        }
        .tier-html th {
            text-align: left;
            padding: 0.65rem 0.85rem;
            background: rgba(59,130,246,0.06);
            border-bottom: 1px solid var(--border-light);
            color: var(--text-primary);
            font-weight: 600;
        }
        .tier-html td {
            padding: 0.55rem 0.85rem;
            border-bottom: 1px solid var(--border);
        }
        .tier-html tr:hover td { background: rgba(255,255,255,0.02); }

        .tier-html pre.mermaid {
            background: #080d18;
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            padding: 1.5rem;
            text-align: center;
        }

        .tier-html img {
            max-width: 100%;
            border-radius: var(--radius-sm);
        }

        /* Tier accent indicator at top of content */
        .tier-accent {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            padding: 0.25rem 0.75rem;
            border-radius: 4px;
            margin-bottom: 1.5rem;
        }
        .tier-accent-public   { background: rgba(16,185,129,0.12); color: var(--accent-green); }
        .tier-accent-internal { background: rgba(59,130,246,0.12); color: var(--accent-blue-light); }
        .tier-accent-technical { background: rgba(139,92,246,0.12); color: var(--accent-purple); }
        .tier-accent-private  { background: rgba(245,158,11,0.12); color: var(--accent-amber); }

        /* ================================================================
           STATUS SECTION
           ================================================================ */
        .status-section { padding: 3rem 0; }
        .status-section-header {
            text-align: center;
            margin-bottom: 2rem;
        }
        .status-section-header p { max-width: 520px; margin: 0.5rem auto 0; font-size: 0.95rem; }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 0.75rem;
        }
        .status-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            padding: 0.85rem 1rem;
            border-left: 3px solid var(--status-planned);
            transition: all 0.3s var(--ease);
        }
        .status-card[data-status="Live"]       { border-left-color: var(--status-live); }
        .status-card[data-status="Complete"]   { border-left-color: var(--status-complete); }
        .status-card[data-status="InProgress"] { border-left-color: var(--status-inprogress); }
        .status-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.2rem;
        }
        .status-card-name  { font-weight: 600; font-size: 0.85rem; }
        .status-card-notes { font-size: 0.78rem; color: var(--text-muted); }

        /* Status badges */
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.12rem 0.5rem;
            border-radius: 9999px;
            font-size: 0.6rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            white-space: nowrap;
        }
        .status-dot { width: 5px; height: 5px; border-radius: 50%; }
        .status-live        { background: rgba(16,185,129,0.12); color: var(--status-live); }
        .status-live .status-dot        { background: var(--status-live); }
        .status-complete    { background: rgba(59,130,246,0.12); color: var(--status-complete); }
        .status-complete .status-dot    { background: var(--status-complete); }
        .status-inprogress  { background: rgba(245,158,11,0.12); color: var(--status-inprogress); }
        .status-inprogress .status-dot  { background: var(--status-inprogress); }
        .status-planned     { background: rgba(100,116,139,0.12); color: var(--status-planned); }
        .status-planned .status-dot     { background: var(--status-planned); }

        /* ================================================================
           FOOTER
           ================================================================ */
        .footer {
            padding: 2rem 0;
            border-top: 1px solid var(--border);
            text-align: center;
            font-size: 0.75rem;
            color: var(--text-dim);
        }

        /* ================================================================
           LOADING
           ================================================================ */
        .loading {
            text-align: center;
            padding: 4rem 0;
            color: var(--text-muted);
            grid-column: 1 / -1;
        }
        .spinner {
            width: 28px; height: 28px;
            border: 3px solid var(--border);
            border-top-color: var(--accent-blue);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin: 0 auto 1rem;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* ================================================================
           SCROLL ANIMATIONS
           ================================================================ */
        .fade-in {
            opacity: 0;
            transform: translateY(12px);
            transition: opacity 0.45s ease, transform 0.45s ease;
        }
        .fade-in.visible { opacity: 1; transform: translateY(0); }

        /* No results message */
        .no-results {
            grid-column: 1 / -1;
            text-align: center;
            padding: 3rem 0;
            color: var(--text-muted);
        }
        .no-results h3 { color: var(--text-secondary); margin-bottom: 0.5rem; }

        /* ================================================================
           RESPONSIVE
           ================================================================ */
        @media (max-width: 1100px) {
            .feature-grid { grid-template-columns: repeat(2, 1fr); }
        }
        @media (max-width: 768px) {
            .feature-grid { grid-template-columns: 1fr; }
            .hero { min-height: 380px; padding: 4rem 1.5rem 2.5rem; }
            .hero-metrics { gap: 0.5rem; }
            .hero-metric-card { min-width: 120px; padding: 0.75rem 1rem; }
            .hero-metric-value { font-size: 1.35rem; }
            .container, .container-xl { padding: 0 1rem; }
            .reading-panel { width: 100vw; }
            .nav-links { display: none; }
            .tier-tabs { padding: 0 1rem; overflow-x: auto; }
            .category-tabs { gap: 0.35rem; }
            .category-tab { padding: 0.4rem 0.85rem; font-size: 0.75rem; }
        }
    </style>
</head>
<body>

    <!-- STICKY NAV -->
    <nav class="nav" id="nav">
        <span class="nav-brand">SmartPiXL Atlas</span>
        <div class="nav-right">
            <div class="nav-links">
                <a href="#capabilities">Docs</a>
                <a href="#systemStatus">Status</a>
            </div>
            <button class="bionic-toggle" id="bionicToggle" title="Bionic Reading — bolds the first half of each word to guide your eye">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 7V4h16v3M9 20h6M12 4v16"/></svg>
                <span>Bionic</span>
                <div class="bionic-switch"></div>
            </button>
        </div>
    </nav>

    <!-- HERO -->
    <header class="hero">
        <div class="hero-glow-1"></div>
        <div class="hero-glow-2"></div>
        <div class="hero-glow-3"></div>
        <div class="hero-grid"></div>
        <div class="hero-content">
            <h1>SmartPiXL Atlas</h1>
            <p class="hero-subtitle">
                Platform documentation. Every subsystem, every enrichment step, every schema &mdash; 
                organized in four depth tiers from overview to implementation detail.
            </p>
            <div class="hero-metrics" id="heroMetrics"></div>
        </div>
    </header>

    <!-- CAPABILITIES -->
    <section id="capabilities">
        <div class="container-xl">
            <!-- Search -->
            <div class="search-container">
                <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
                <input type="text" class="search-input" id="searchInput" placeholder="Search documentation..." autocomplete="off" spellcheck="false">
            </div>

            <!-- Category Tabs -->
            <div class="category-tabs" id="categoryTabs"></div>

            <!-- Card Grid -->
            <div class="feature-grid" id="featureGrid">
                <div class="loading"><div class="spinner"></div>Loading documentation...</div>
            </div>
        </div>
    </section>

    <!-- READING PANEL (slide-in overlay) -->
    <div class="reading-overlay" id="readingOverlay" onclick="closeReading()"></div>
    <aside class="reading-panel" id="readingPanel">
        <div class="reading-header">
            <div class="reading-title-group">
                <div class="reading-icon" id="readingIcon"></div>
                <div>
                    <div class="reading-title" id="readingTitle"></div>
                    <div class="reading-category" id="readingCategory"></div>
                </div>
            </div>
            <button class="reading-close" onclick="closeReading()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
            </button>
        </div>
        <div class="tier-tabs" id="tierTabs"></div>
        <div class="reading-body" id="readingBody"></div>
    </aside>

    <!-- Bionic toggle (floating, always visible) -->
    <button class="bionic-toggle" id="bionicToggleFloat" style="position:fixed;bottom:1.5rem;right:1.5rem;z-index:3000;display:none" title="Toggle Bionic Reading">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 7V4h16v3M9 20h6M12 4v16"/></svg>
        <span>Bionic</span>
        <div class="bionic-switch"></div>
    </button>

    <!-- SYSTEM STATUS -->
    <section class="status-section" id="systemStatus" style="display:none">
        <div class="container-xl">
            <div class="status-section-header">
                <h2>System Status</h2>
                <p>Verified against the live codebase. Every status is backed by real, deployed code.</p>
            </div>
            <div class="status-grid" id="statusGrid"></div>
        </div>
    </section>

    <!-- FOOTER -->
    <footer class="footer">
        <div class="container">
            SmartPiXL Atlas &middot; Markdown-backed documentation &middot; <span id="loadTime"></span>
        </div>
    </footer>

    <!-- ============================================================
         JAVASCRIPT
         ============================================================ -->
    <script>
        // ================================================================
        // CONFIG
        // ================================================================
        mermaid.initialize({
            startOnLoad: false,
            theme: 'dark',
            themeVariables: {
                darkMode: true,
                primaryColor: '#3b82f6',
                primaryTextColor: '#edf2f7',
                primaryBorderColor: '#334155',
                lineColor: '#64748b',
                secondaryColor: '#1a2540',
                tertiaryColor: '#111827',
                background: '#080d18',
                mainBkg: '#1a2540',
                nodeBorder: '#334155',
                clusterBkg: '#111827',
                clusterBorder: '#1e293b',
                titleColor: '#edf2f7',
                edgeLabelBackground: '#111827'
            },
            flowchart: { useMaxWidth: true, htmlLabels: true },
            sequence: { useMaxWidth: true },
            gantt: { useMaxWidth: true }
        });

        // ================================================================
        // STATE
        // ================================================================
        let allSections = [];
        let allStatuses = [];
        let allMetrics  = [];
        let selectedSlug = null;
        let activeCategory = 'All';
        let searchQuery = '';
        let bionicEnabled = false;

        // ================================================================
        // UTILITIES
        // ================================================================
        async function fetchJson(url) {
            const r = await fetch(url);
            if (!r.ok) throw new Error(`${url}: ${r.status}`);
            return r.json();
        }

        function statusBadge(status) {
            const cls = (status || 'planned').toLowerCase().replace(/\s+/g, '');
            return `<span class="status-badge status-${cls}"><span class="status-dot"></span>${status}</span>`;
        }

        function escapeHtml(str) {
            return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
        }

        // ================================================================
        // BIONIC READING
        // ================================================================
        function applyBionicReading(element) {
            if (!element) return;
            // Walk text nodes in specific elements
            const targets = element.querySelectorAll('p, li, td, .card-pitch p, .hero-subtitle');
            targets.forEach(el => {
                if (el.dataset.bionicOriginal) return; // Already processed
                el.dataset.bionicOriginal = el.innerHTML;
                el.innerHTML = bionicTransform(el.innerHTML);
            });
        }

        function removeBionicReading(element) {
            if (!element) return;
            const targets = element.querySelectorAll('[data-bionic-original]');
            targets.forEach(el => {
                el.innerHTML = el.dataset.bionicOriginal;
                delete el.dataset.bionicOriginal;
            });
        }

        function bionicTransform(html) {
            // Process text outside of HTML tags
            // Split by tags, apply bionic to text segments only
            const parts = html.split(/(<[^>]+>)/g);
            return parts.map(part => {
                if (part.startsWith('<')) return part; // HTML tag — leave as-is
                if (!part.trim()) return part; // Whitespace only

                // Split into words, bold the first portion of each
                return part.replace(/\b([a-zA-Z\u00C0-\u024F]+)\b/g, (word) => {
                    if (word.length <= 1) return `<b class="bionic-bold">${word}</b>`;
                    // Bold ~40% of the word (minimum 1 char, round up)
                    const boldLen = Math.max(1, Math.ceil(word.length * 0.4));
                    const boldPart = word.slice(0, boldLen);
                    const rest = word.slice(boldLen);
                    return `<b class="bionic-bold">${boldPart}</b>${rest}`;
                });
            }).join('');
        }

        function toggleBionic() {
            bionicEnabled = !bionicEnabled;
            document.body.classList.toggle('bionic-reading', bionicEnabled);

            // Update all toggle buttons
            document.querySelectorAll('.bionic-toggle').forEach(btn => {
                btn.classList.toggle('active', bionicEnabled);
            });

            // Apply/remove from visible content
            if (bionicEnabled) {
                applyBionicReading(document.getElementById('featureGrid'));
                applyBionicReading(document.querySelector('.hero'));
                const readingBody = document.getElementById('readingBody');
                if (readingBody.innerHTML) applyBionicReading(readingBody);
            } else {
                removeBionicReading(document.getElementById('featureGrid'));
                removeBionicReading(document.querySelector('.hero'));
                removeBionicReading(document.getElementById('readingBody'));
            }

            // Persist preference
            try { localStorage.setItem('atlas-bionic', bionicEnabled ? '1' : '0'); } catch(e) {}
        }

        // Restore preference
        try {
            if (localStorage.getItem('atlas-bionic') === '1') {
                bionicEnabled = true;
                document.body.classList.add('bionic-reading');
                document.querySelectorAll('.bionic-toggle').forEach(btn => btn.classList.add('active'));
            }
        } catch(e) {}

        // Wire up both toggle buttons
        document.getElementById('bionicToggle').addEventListener('click', toggleBionic);
        document.getElementById('bionicToggleFloat').addEventListener('click', toggleBionic);

        // ================================================================
        // COUNTER ANIMATION
        // ================================================================
        function animateCounter(el, target) {
            const match = target.match(/^([\d,.]+)(.*)/);
            if (!match) { el.textContent = target; return; }
            const num = parseFloat(match[1].replace(/,/g, ''));
            const suffix = match[2];
            const duration = 1600;
            const start = performance.now();
            function tick(now) {
                const p = Math.min((now - start) / duration, 1);
                const ease = 1 - Math.pow(1 - p, 3);
                el.textContent = Math.round(num * ease).toLocaleString() + suffix;
                if (p < 1) requestAnimationFrame(tick);
            }
            requestAnimationFrame(tick);
        }

        // ================================================================
        // HERO METRICS
        // ================================================================
        function renderHeroMetrics(metrics) {
            const container = document.getElementById('heroMetrics');
            const global = metrics.filter(m => m.sectionId === null);
            if (!global.length) {
                // Fallback static metrics
                container.innerHTML = [
                    { value: '159', label: 'Browser Signals' },
                    { value: '230+', label: 'Data Points' },
                    { value: '80+', label: 'Bot Signals' },
                    { value: '15', label: 'Enrichment Steps' },
                    { value: '60s', label: 'ETL Cadence' }
                ].map(m => `
                    <div class="hero-metric-card fade-in">
                        <div class="hero-metric-value" data-counter="${m.value}">${m.value}</div>
                        <div class="hero-metric-label">${m.label}</div>
                    </div>
                `).join('');
            } else {
                container.innerHTML = global.map(m => `
                    <div class="hero-metric-card fade-in">
                        <div class="hero-metric-value" data-counter="${m.value}">${m.value}</div>
                        <div class="hero-metric-label">${m.label}</div>
                    </div>
                `).join('');
            }

            container.querySelectorAll('[data-counter]').forEach(el => {
                animateCounter(el, el.dataset.counter);
            });
            requestAnimationFrame(() => {
                container.querySelectorAll('.fade-in').forEach((el, i) => {
                    setTimeout(() => el.classList.add('visible'), i * 100);
                });
            });
        }

        // ================================================================
        // CATEGORY TABS
        // ================================================================
        function renderCategoryTabs(sections) {
            const container = document.getElementById('categoryTabs');
            const categories = ['All', ...new Set(sections.map(s => s.category))];

            container.innerHTML = categories.map(cat => {
                const count = cat === 'All' ? sections.length : sections.filter(s => s.category === cat).length;
                return `<button class="category-tab${cat === activeCategory ? ' active' : ''}" 
                         onclick="filterCategory('${cat}')">
                    ${cat}<span class="tab-count">${count}</span>
                </button>`;
            }).join('');
        }

        function filterCategory(cat) {
            activeCategory = cat;
            document.querySelectorAll('.category-tab').forEach(btn => {
                btn.classList.toggle('active', btn.textContent.trim().startsWith(cat));
            });
            renderFeatureGrid();
        }

        // ================================================================
        // SEARCH
        // ================================================================
        document.getElementById('searchInput').addEventListener('input', (e) => {
            searchQuery = e.target.value.toLowerCase().trim();
            renderFeatureGrid();
        });

        // ================================================================
        // FEATURE GRID
        // ================================================================
        function renderFeatureGrid() {
            const grid = document.getElementById('featureGrid');
            let filtered = allSections;

            if (activeCategory !== 'All') {
                filtered = filtered.filter(s => s.category === activeCategory);
            }

            if (searchQuery) {
                filtered = filtered.filter(s => {
                    const text = (s.title + ' ' + s.category + ' ' + (s.slug || '') + ' ' + stripHtml(s.pitchHtml || '')).toLowerCase();
                    return text.includes(searchQuery);
                });
            }

            if (filtered.length === 0) {
                grid.innerHTML = `<div class="no-results"><h3>No matching docs</h3><p>Try a different search term or category.</p></div>`;
                return;
            }

            grid.innerHTML = filtered.map((section, idx) => {
                const icon = section.iconClass || 'file-text';
                const hasTiers = [section.pitchHtml, section.managementHtml, section.technicalHtml, section.walkthroughHtml];

                return `
                <div class="feature-card fade-in" data-slug="${section.slug}" data-category="${section.category}"
                     onclick="openReading('${section.slug}')"
                     style="transition-delay: ${Math.min(idx * 50, 300)}ms">
                    <div class="card-header">
                        <div class="card-icon"><i data-lucide="${icon}"></i></div>
                        <div class="card-title-group">
                            <div class="card-title">${escapeHtml(section.title)}</div>
                            <div class="card-category">${escapeHtml(section.category)}</div>
                        </div>
                    </div>
                    <div class="card-pitch">${section.pitchHtml || '<p>Documentation available &mdash; click to read.</p>'}</div>
                    <div class="card-footer">
                        <div class="card-tier-dots" title="Available tiers: ${hasTiers.filter(Boolean).length}/4">
                            <div class="tier-dot t1 ${hasTiers[0] ? 'filled' : ''}" title="Public"></div>
                            <div class="tier-dot t2 ${hasTiers[1] ? 'filled' : ''}" title="Internal"></div>
                            <div class="tier-dot t3 ${hasTiers[2] ? 'filled' : ''}" title="Technical"></div>
                            <div class="tier-dot t4 ${hasTiers[3] ? 'filled' : ''}" title="Private"></div>
                        </div>
                        <button class="card-explore" onclick="event.stopPropagation(); openReading('${section.slug}')">
                            Read
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round">
                                <line x1="5" y1="12" x2="19" y2="12"/>
                                <polyline points="12 5 19 12 12 19"/>
                            </svg>
                        </button>
                    </div>
                </div>`;
            }).join('');

            if (window.lucide) lucide.createIcons();
            observeAnimations();

            // Reapply bionic if enabled
            if (bionicEnabled) {
                setTimeout(() => applyBionicReading(grid), 50);
            }
        }

        function stripHtml(html) {
            const tmp = document.createElement('div');
            tmp.innerHTML = html;
            return tmp.textContent || '';
        }

        // ================================================================
        // READING PANEL — Open / Close
        // ================================================================
        function openReading(slug) {
            const section = allSections.find(s => s.slug === slug);
            if (!section) return;

            selectedSlug = slug;

            // Update header
            const icon = section.iconClass || 'file-text';
            document.getElementById('readingIcon').innerHTML = `<i data-lucide="${icon}"></i>`;
            document.getElementById('readingTitle').textContent = section.title;
            document.getElementById('readingCategory').textContent = section.category;

            // Build tier tabs
            const tiers = [
                { key: 'public',    label: 'Public',    html: section.pitchHtml,       accent: 'public' },
                { key: 'internal',  label: 'Internal',  html: section.managementHtml,  accent: 'internal' },
                { key: 'technical', label: 'Technical', html: section.technicalHtml,   accent: 'technical' },
                { key: 'private',   label: 'Private',   html: section.walkthroughHtml, accent: 'private' }
            ].filter(t => t.html);

            const tierTabs = document.getElementById('tierTabs');
            tierTabs.innerHTML = tiers.map((t, i) => `
                <button class="tier-tab t-${t.key} ${i === 0 ? 'active' : ''}" 
                        data-tier="${t.key}" onclick="switchTier('${t.key}')">
                    <span class="tier-tab-label">
                        <span class="tier-indicator"></span>
                        ${t.label}
                    </span>
                </button>
            `).join('');

            // Build content
            const body = document.getElementById('readingBody');
            let contentHtml = '';

            // Mermaid diagram (shown above all tiers)
            if (section.mermaidDiagram) {
                contentHtml += `<div class="reading-diagram"><pre class="mermaid">${section.mermaidDiagram}</pre></div>`;
            }

            // Tier content blocks
            contentHtml += tiers.map((t, i) => `
                <div class="tier-content ${i === 0 ? 'active' : ''}" data-tier="${t.key}">
                    <div class="tier-accent tier-accent-${t.accent}">
                        Atlas ${t.label}
                    </div>
                    <div class="tier-html">${t.html}</div>
                </div>
            `).join('');

            body.innerHTML = contentHtml;
            body.scrollTop = 0;

            // Show panel
            document.getElementById('readingOverlay').classList.add('open');
            document.getElementById('readingPanel').classList.add('open');
            document.body.style.overflow = 'hidden';

            // Show floating bionic toggle
            document.getElementById('bionicToggleFloat').style.display = '';

            // Highlight active card
            document.querySelectorAll('.feature-card').forEach(c => c.classList.remove('active'));
            const card = document.querySelector(`.feature-card[data-slug="${slug}"]`);
            if (card) card.classList.add('active');

            // Init icons + Mermaid
            if (window.lucide) lucide.createIcons();
            setTimeout(async () => {
                const diagrams = body.querySelectorAll('.mermaid:not([data-processed])');
                if (diagrams.length > 0) {
                    try { await mermaid.run({ nodes: diagrams }); }
                    catch (e) { console.warn('Mermaid render:', e); }
                }
            }, 200);

            // Apply bionic if enabled
            if (bionicEnabled) {
                setTimeout(() => applyBionicReading(body), 100);
            }
        }

        function closeReading() {
            selectedSlug = null;
            document.getElementById('readingOverlay').classList.remove('open');
            document.getElementById('readingPanel').classList.remove('open');
            document.body.style.overflow = '';
            document.getElementById('bionicToggleFloat').style.display = 'none';
            document.querySelectorAll('.feature-card').forEach(c => c.classList.remove('active'));
        }

        function switchTier(tier) {
            // Update tab buttons
            document.querySelectorAll('.tier-tab').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.tier === tier);
            });
            // Show matching content
            document.querySelectorAll('.tier-content').forEach(el => {
                el.classList.toggle('active', el.dataset.tier === tier);
            });
            // Scroll to top of reading body
            document.getElementById('readingBody').scrollTop = 0;

            // Reapply bionic if enabled
            if (bionicEnabled) {
                const body = document.getElementById('readingBody');
                removeBionicReading(body);
                applyBionicReading(body);
            }
        }

        // ================================================================
        // STATUS GRID
        // ================================================================
        function renderStatusGrid(statuses) {
            if (!statuses.length) return;

            document.getElementById('systemStatus').style.display = '';
            const grid = document.getElementById('statusGrid');

            const order = { 'Live': 0, 'Complete': 1, 'InProgress': 2, 'Planned': 3 };
            statuses.sort((a, b) => (order[a.status] ?? 9) - (order[b.status] ?? 9));

            grid.innerHTML = statuses.map(s => `
                <div class="status-card fade-in" data-status="${s.status}">
                    <div class="status-card-header">
                        <span class="status-card-name">${escapeHtml(s.systemName)}</span>
                        ${statusBadge(s.status)}
                    </div>
                    ${s.notes ? `<div class="status-card-notes">${escapeHtml(s.notes)}</div>` : ''}
                </div>
            `).join('');

            observeAnimations();
        }

        // ================================================================
        // INTERSECTION OBSERVER FOR ANIMATIONS
        // ================================================================
        function observeAnimations() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.06 });
            document.querySelectorAll('.fade-in:not(.visible)').forEach(el => observer.observe(el));
        }

        // ================================================================
        // NAV SCROLL BEHAVIOR
        // ================================================================
        window.addEventListener('scroll', () => {
            document.getElementById('nav').classList.toggle('visible', window.scrollY > 250);
        }, { passive: true });

        // ================================================================
        // KEYBOARD SHORTCUTS
        // ================================================================
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && selectedSlug !== null) closeReading();
            // Ctrl+K or / to focus search
            if ((e.key === '/' || (e.ctrlKey && e.key === 'k')) && !selectedSlug) {
                e.preventDefault();
                document.getElementById('searchInput').focus();
            }
        });

        // ================================================================
        // INIT
        // ================================================================
        async function init() {
            document.getElementById('loadTime').textContent = new Date().toLocaleString();

            try {
                // Sections from markdown, status + metrics from SQL (with graceful fallback)
                const [sections, statuses, metrics] = await Promise.all([
                    fetchJson('/api/atlas/sections'),
                    fetchJson('/api/atlas/status').catch(() => []),
                    fetchJson('/api/atlas/metrics').catch(() => [])
                ]);

                allSections = sections;
                allStatuses = statuses;
                allMetrics  = metrics;

                renderHeroMetrics(metrics);
                renderCategoryTabs(sections);
                renderFeatureGrid();
                renderStatusGrid(statuses);

                // Apply bionic to hero if already enabled on load
                if (bionicEnabled) {
                    setTimeout(() => {
                        applyBionicReading(document.querySelector('.hero'));
                        applyBionicReading(document.getElementById('featureGrid'));
                    }, 200);
                }

            } catch (err) {
                console.error('Atlas init error:', err);
                document.getElementById('featureGrid').innerHTML = `
                    <div class="loading" style="color:var(--accent-red)">
                        Failed to load documentation.<br>
                        <small>${err.message}</small>
                    </div>`;
            }
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }
    </script>
</body>
</html>
