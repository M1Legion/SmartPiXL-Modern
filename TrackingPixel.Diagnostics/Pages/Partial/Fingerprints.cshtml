@page "/partial/fingerprints"
@using TrackingPixel.Diagnostics.Services
@inject MetricsService Metrics

@{
    Layout = null;
    var fp = await Metrics.GetFingerprintMetricsAsync();
    var total = fp.TotalUnique > 0 ? fp.TotalUnique : 1;
}

<div class="grid-2">
    <div>
        <h3>Fingerprint Uniqueness</h3>
        <table>
            <tr>
                <th>Metric</th>
                <th>Value</th>
            </tr>
            <tr>
                <td>Total Unique Fingerprints</td>
                <td><strong>@fp.TotalUnique.ToString("N0")</strong></td>
            </tr>
            <tr>
                <td>Collision Rate</td>
                <td>@fp.CollisionRate%</td>
            </tr>
            <tr>
                <td>Unique Canvas Hashes</td>
                <td>@fp.CanvasUnique.ToString("N0")</td>
            </tr>
            <tr>
                <td>Unique WebGL Hashes</td>
                <td>@fp.WebGLUnique.ToString("N0")</td>
            </tr>
            <tr>
                <td>Unique Audio Fingerprints</td>
                <td>@fp.AudioUnique.ToString("N0")</td>
            </tr>
            <tr>
                <td>Font Combinations</td>
                <td>@fp.FontCombinations.ToString("N0")</td>
            </tr>
            <tr>
                <td>Screen Resolutions</td>
                <td>@fp.ScreenResolutions.ToString("N0")</td>
            </tr>
        </table>
    </div>
    <div>
        <h3>Signal Contribution</h3>
        <div style="margin-top: 1rem;">
            <div style="margin-bottom: 1rem;">
                <div style="display: flex; justify-content: space-between;">
                    <span>Canvas</span>
                    <span>@fp.CanvasUnique unique</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: @(Math.Min(100, fp.CanvasUnique * 100 / total))%; background: #4fc3f7;"></div>
                </div>
            </div>
            <div style="margin-bottom: 1rem;">
                <div style="display: flex; justify-content: space-between;">
                    <span>WebGL</span>
                    <span>@fp.WebGLUnique unique</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: @(Math.Min(100, fp.WebGLUnique * 100 / total))%; background: #66bb6a;"></div>
                </div>
            </div>
            <div style="margin-bottom: 1rem;">
                <div style="display: flex; justify-content: space-between;">
                    <span>Audio</span>
                    <span>@fp.AudioUnique unique</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: @(Math.Min(100, fp.AudioUnique * 100 / total))%; background: #ffa726;"></div>
                </div>
            </div>
            <div style="margin-bottom: 1rem;">
                <div style="display: flex; justify-content: space-between;">
                    <span>Fonts</span>
                    <span>@fp.FontCombinations combos</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: @(Math.Min(100, fp.FontCombinations * 100 / total))%; background: #ab47bc;"></div>
                </div>
            </div>
            <div style="margin-bottom: 1rem;">
                <div style="display: flex; justify-content: space-between;">
                    <span>Screen</span>
                    <span>@fp.ScreenResolutions resolutions</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: @(Math.Min(100, fp.ScreenResolutions * 100 / total))%; background: #ef5350;"></div>
                </div>
            </div>
        </div>
    </div>
</div>
